# K9s RCA Plugin Configuration
# 
# PREREQUISITES (required - can be set via env vars or -- flags):
# export KOMODOR_API_KEY="your-komodor-api-token"
# Or use: --api-key --cluster
#
# USAGE GUIDE:
# - Press Shift-K while viewing any supported Kubernetes resource to trigger RCA analysis
# - The --cluster=$CLUSTER parameter must match your Komodor cluster name exactly
# - To find your cluster name: log into Komodor dashboard and check the cluster selector
# - To find your local cluster name run `kubectl config get-clusters` (k9s will automatically set it to $CLUSTER)
# - If cluster name doesn't match, RCA analysis will fail or analyze wrong cluster
#
# SUPPORTED RESOURCES:
# - Pods (po), Deployments (deploy), Services (svc), StatefulSets (sts)
# - DaemonSets (ds), Ingress (ing), ConfigMaps (cm), Secrets (sec)
# - PersistentVolumeClaims (pvc), Jobs (job), CronJobs (cj), ReplicaSets (rs)
# - HorizontalPodAutoscalers (hpa), PodDisruptionBudgets (pdb), NetworkPolicies (np)
#
# K9S PLUGINS DOCUMENTATION:
# - https://k9scli.io/topics/plugins/
# - Available environment variables: $NAMESPACE, $NAME, $CLUSTER, $CONTEXT, $RESOURCE_NAME, $USER, $GROUPS, etc.
#
plugins:
  rca-resource:
    shortCut: Shift-K
    description: "Komodor RCA"
    scopes:
    - po
    - deploy
    - svc
    - sts
    - ds
    - ing
    - cm
    - sec
    - pvc
    - job
    - cj
    - rs
    - hpa
    - pdb
    - np
    command: k9s-rca
    background: false
    args:
    - --kind=$RESOURCE_NAME
    - --namespace=$NAMESPACE
    - --name=$NAME
    - --cluster=$CLUSTER
    - --context=$CONTEXT
    - --poll